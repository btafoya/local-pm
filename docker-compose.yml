services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        DATABASE_URI: mongodb://mongodb:27017/local-pm
        PAYLOAD_SECRET: ${PAYLOAD_SECRET:-local-pm-secret-key-for-development-only}
        NEXT_PUBLIC_SERVER_URL: ${NEXT_PUBLIC_SERVER_URL:-http://localhost:3010}
    container_name: local-pm-app
    restart: unless-stopped
    ports:
      - "3010:3010"
    environment:
      DATABASE_URI: mongodb://mongodb:27017/local-pm
      PAYLOAD_SECRET: ${PAYLOAD_SECRET:-local-pm-secret-key-for-development-only}
      NEXT_PUBLIC_SERVER_URL: ${NEXT_PUBLIC_SERVER_URL:-http://localhost:3010}
    depends_on:
      - mongodb

  mongodb:
    image: mongo:7.0
    container_name: local-pm-mongodb
    restart: unless-stopped
    ports:
      - "27018:27017"
    volumes:
      - local-pm-mongodb-data:/data/db
    environment:
      MONGO_INITDB_DATABASE: local-pm

volumes:
  local-pm-mongodb-data:
